/**
 * angular-localization :: v1.2.1 :: 2015-04-17
 * web: https://github.com/doshprompt/angular-localization
 *
 * Copyright (c) 2015 | Rahul Doshi
 * License: MIT
 */
!function(a){"use strict";a.module("ngLocalize.Config",[]).value("localeConf",{basePath:"languages",defaultLocale:"en-US",sharedDictionary:"common",fileExtension:".lang.json",persistSelection:!0,cookieName:"COOKIE_LOCALE_LANG",observableAttrs:new RegExp("^data-(?!ng-|i18n)"),delimiter:"::"}),a.module("ngLocalize.Events",[]).constant("localeEvents",{resourceUpdates:"ngLocalizeResourcesUpdated",localeChanges:"ngLocalizeLocaleChanged"}),a.module("ngLocalize",["ngSanitize","ngLocalize.Config","ngLocalize.Events","ngLocalize.InstalledLanguages"]).service("locale",["$injector","$http","$q","$log","$rootScope","$window","localeConf","localeEvents","localeSupported","localeFallbacks",function(b,c,d,e,f,g,h,i,j,k){function l(a){return a&&a.length&&A.test(a)}function m(a){var b=a?a.split("."):"",c="";return b.length>1&&(c=b.slice(0,-1).join(".")),c}function n(a){var b=a?a.split("."):[],c="";return b.length&&(c=b[b.length-1]),c}function o(a){var b,c=null,d=a?a.split("."):[];if(d.length>1)for(c=y,b=0;b<d.length-1;b++){if(!c[d[b]]){c=null;break}c=c[d[b]]}return c}function p(a){var b,d=a?a.split("."):"",g=y,j=h.basePath+"/"+w;if(d.length>1){for(b=0;b<d.length-1;b++)g[d[b]]||(g[d[b]]={}),g=g[d[b]],j+="/"+d[b];g._loading||(g._loading=!0,j+=h.fileExtension,c.get(j).success(function(b){var c,d=m(a);for(c in b)b.hasOwnProperty(c)&&(g[c]=b[c]);delete g._loading,f.$broadcast(i.resourceUpdates),x[d]&&x[d].resolve(d)}).error(function(){e.error("[localizationService] Failed to load: "+j),delete g._loading}))}}function q(a){var b,c;return a=a||h.langFile,c=a+"._LOOKUP_",b=o(c),x[a]||(x[a]=d.defer()),b&&!b._loading?x[a].resolve(a):b||p(c),x[a].promise}function r(b){var c,e,f;if(a.isString(b))c=b.split(",");else{if(!a.isArray(b))throw new Error("locale.ready requires either an Array or comma-separated list.");c=b}return c.length>1?(f=[],c.forEach(function(a){f.push(q(a))}),e=d.all(f)):e=q(b),e}function s(b,c){var d=b,e=0;return c&&(a.isArray(c)?a.forEach(c,function(a,b){d=d.replace("%"+(b+1),a),d=d.replace("{"+(b+1)+"}",a)}):a.forEach(c,function(a,b){++e,d=d.replace("{"+b+"}",a),d=d.replace("%"+b,a),d=d.replace("%"+e,a),d=d.replace("{"+e+"}",a)})),d=d.replace(/\n/g,"<br>")}function t(b,c){var d,f,g,i="",j=!1;return a.isString(b)&&!c&&-1!=b.indexOf(h.delimiter)&&(g=b.split(h.delimiter),b=g[0],c=a.fromJson(g[1])),j=l(b),j?(a.isObject(c)||(c=[c]),d=o(b),d&&!d._loading?(f=n(b),d[f]?i=s(d[f],c):(e.info("[localizationService] Key not found: "+b),i="%%KEY_NOT_FOUND%%")):d||p(b)):i=b,i}function u(b){var c;a.isString(b)?(b=b.trim(),-1!=j.indexOf(b)?c=b:(c=k[b.split("-")[0]],a.isUndefined(c)&&(c=h.defaultLocale))):c=h.defaultLocale,c!=w&&(y={},x={},w=c,f.$broadcast(i.localeChanges,w),f.$broadcast(i.resourceUpdates),z&&z.put(h.cookieName,c))}function v(){return w}var w,x,y,z,A=new RegExp("^[\\w\\.-]+\\.[\\w\\s\\.-]+\\w(:.*)?$");return h.persistSelection&&b.has("$cookieStore")&&(z=b.get("$cookieStore")),u(z?z.get(h.cookieName):g.navigator.userLanguage||g.navigator.language),{ready:r,isToken:l,getPath:m,getKey:n,setLocale:u,getLocale:v,getString:t}}]).filter("i18n",["locale",function(a){var b=function(b,c){return a.getString(b,c)};return b.$stateful=!0,b}]).directive("i18n",["$sce","locale","localeEvents","localeConf",function(b,c,d,e){function f(a,c){c!==a.html()&&a.html(b.getTrustedHtml(c))}function g(a,b,d){c.isToken(b)?c.ready(c.getPath(b)).then(function(){f(a,c.getString(b,d))}):f(a,b)}return function(b,c,f){var h;f.$observe("i18n",function(a,b){a&&a!=b&&g(c,a,h)}),a.forEach(f.$attr,function(a,b){e.observableAttrs.test(a)&&f.$observe(b,function(a,d){(a&&a!=d||!h||!h[b])&&(h=h||{},h[b]=f[b],g(c,f.i18n,h))})}),b.$on(d.resourceUpdates,function(){g(c,f.i18n,h)}),b.$on(d.localeChanges,function(){g(c,f.i18n,h)})}}]).directive("i18nAttr",["locale","localeEvents",function(a,b){return function(c,d,e){function f(b,d){var f,h=c.$eval(d),i=[];for(var j in h)f=h[j],a.isToken(f)&&-1==i.indexOf(a.getPath(f))&&i.push(a.getPath(f));a.ready(i).then(function(){var b="";for(var c in h)f=h[c],b=a.getString(f),g[c]!==b&&e.$set(c,g[c]=b)})}var g={};e.$observe("i18nAttr",function(a,b){a&&a!=b&&f(d,a)}),c.$on(b.resourceUpdates,function(){f(d,e.i18nAttr)}),c.$on(b.localeChanges,function(){f(d,e.i18nAttr)})}}]),a.module("ngLocalize.InstalledLanguages",[]).value("localeSupported",["en-US"]).value("localeFallbacks",{en:"en-US"}),a.module("ngLocalize.Version",[]).constant("localeVer","1.2.1")}(window.angular,window,document);
//# sourceMappingURL=angular-localization.min.map